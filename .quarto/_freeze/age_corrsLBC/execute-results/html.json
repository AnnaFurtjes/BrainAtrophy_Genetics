{
  "hash": "9c8f1d8828261abb273aa7f73b8e4c0e",
  "result": {
    "markdown": "---\ntitle: \"Lifetime brain atrophy increases with age within individuals in LBC1936\"\nformat: \n  html:\n    code-fold: true\nauthor: \"Anna Elisabeth Furtjes\"\ndate: \"04 November 2024\"\noutput: html\ndoi: test\n---\n\n\n------------------------------------------------------------------------\n\nThis analysis was moved to the Supplement during revisions of the paper. It shows that measures of lifetime brain atrophy worsen over a 9-year period in LBC1936, even when we cross-sectionally process our neuroimaging data (as opposed to using FS longitudinal processing).\n\nNeuroimaging data used here was prepared using code displayed in 'Data preparation': LBC: [neuroimaging](../_site/LBC_neuro.html) data.\n\n\n\n\n\n\n\n# Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(data.table)\nlibrary(ggpubr)\nlibrary(patchwork)\n```\n:::\n\n\n\n# Define function\n\nThis function plots trajectories of a variable across multiple time points. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotTraject <- function(dat = all, y = \"diff\", col = \"#D81B60\"){\n\n\t# change variable naming for plot to work in function \n\tnames(dat)[which(names(dat) == y)] <- \"y\"\n\n\tp = ggplot(data = dat)+\n\t\t  geom_point(aes(x = age, y = y, group = lbc36no), color = \"#82A0D8\", size = .5)+\n\t\t  geom_line(aes(x = age, y = y, group=as.factor(lbc36no)), color = col, linewidth = 0.2, alpha = .6) +\n\t    geom_smooth(aes(x = age, y = y), method = \"lm\", se = F) +\n\t    xlab(\"Age in years\")+\n\t    ylab(\"\")+\n\t    scale_x_continuous(breaks = c(73, 76, 79, 82))+\n\t\t\ttheme(legend.position = \"none\")+\n\t\t\ttheme_bw()+\n\t\t\ttheme(text = element_text(size=10),\n\t\t\t\t  plot.margin=unit(c(1, 1, 1, 1), \"cm\"),\n\t\t\t\t  axis.text.y = element_text(size = 9),\n\t\t\t\t  axis.text.x = element_text(size = 9),\n\t\t\t\t  axis.title.y = element_text(size = 9, color = \"grey\"),\n\t\t\t\t  plot.title = element_text(size = 12, hjust = 0),\n\t\t\t\t  panel.border = element_blank())\n\t\n\treturn(p)\n}\n```\n:::\n\n\n\n## Read in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get cross-sectionally processed data from \n# wave 1\nwave1 = fread(paste0(wd, \"/LBC1936_crossNeuroWave1.txt\"))\nwave1$wave = \"wave 2\"\nwave1$age = 73\n# wave 2\nwave2 = fread(paste0(wd, \"/LBC1936_crossNeuroWave2.txt\"))\nwave2$wave = \"wave 3\"\nwave2$age = 76\n# wave 3\nwave3 = fread(paste0(wd, \"/LBC1936_crossNeuroWave3.txt\"))\nwave3$wave = \"wave 4\"\nwave3$age = 79\n# wave 4\nwave4 = fread(paste0(wd, \"/LBC1936_crossNeuroWave4.txt\"))\nwave4$wave = \"wave 5\"\nwave4$age = 82\n\n# rbind wave data\nall = rbind(wave1, wave2, wave3, wave4)\n\n# only keep participants who have all measurement points\nsave = table(all$lbc36no) == 4\nIDs = dimnames(save)[[1]][as.vector(save)]\nall = all[all$lbc36no %in% IDs,]\n\n#### later edit: so far this data has a residual score for each of the visits meaning that there can never be an increase with age in the residual score\n# Hence, here we standardise across all waves to be able to compare different time points\n# estimate residual model\nmodel <- lm(TBV ~ ICV, data = all)\nall$residALL = as.vector(resid(model, na.rm=T))\n```\n:::\n\n\n## Plot trajectories\n\nThis is now Supplementary Figure 12. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np_diff = plotTraject(dat = all, y = \"diff\", col = \"#D81B60\") + \n  ggtitle(\"Raw difference score\")+\n  ylab(\"<- less atrophy         more atrophy ->\")\n\np_ratio = plotTraject(dat = all, y = \"ratio\", col = \"#FFC107\") + \n  ggtitle(\"Raw ratio score\") + \n  scale_y_reverse() + \n  ylab(\"<- less atrophy         more atrophy ->\")\n\np_resid = plotTraject(dat = all, y = \"residALL\", col = \"#004D40\") + \n  ggtitle(\"Raw residual score\")+ \n  scale_y_reverse()+ \n  ylab(\"<- less atrophy         more atrophy ->\")\n\n#cowplot::plot_grid(p_diff, p_ratio, p_resid, nrow = 1, labels = c(\"A\", \"B\", \"C\"), label_size = 6, rel_widths = c(1,1,1))\n## overall title: \"Estimated brain atrophy in LBC1936 (cross-sectional processing)\"\nplot = (p_diff | p_ratio | p_resid) + \n\tplot_annotation(title = \"Lifetime brain atrophy\\n(estimated from cross-sectionally processed measures of TBV and ICV)\", \n\t                tag_levels = \"A\",\n\t\t\t\t\t        theme = theme(plot.tag = element_text(face = \"bold\"),\n\t\t\t\t\t              plot.title = element_text(face = \"bold\", size = 20, hjust = 0.5)))\n\nggsave(\"EstimatedAtrophy_LBC1936_wave2to5.jpg\", bg = \"white\",plot = plot, width = 35, height = 20, units = \"cm\", dpi = 150)\n```\n:::\n\n\n![](images/EstimatedAtrophy_LBC1936_wave2to5.jpg){fig-align=\"center\"}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}