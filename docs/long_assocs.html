<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anna Elisabeth Furtjes">
<meta name="dcterms.date" content="2024-11-14">

<title>Brain Atrophy Genetics - Lifetime brain atrophy is correlated with longitudinally-observed atrophic changes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Brain Atrophy Genetics</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Overview</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#define-function" id="toc-define-function" class="nav-link" data-scroll-target="#define-function">Define function</a></li>
  <li><a href="#pearsons-correlations" id="toc-pearsons-correlations" class="nav-link" data-scroll-target="#pearsons-correlations">Pearson’s correlations</a>
  <ul class="collapse">
  <li><a href="#lbc" id="toc-lbc" class="nav-link" data-scroll-target="#lbc">LBC</a></li>
  <li><a href="#ukb" id="toc-ukb" class="nav-link" data-scroll-target="#ukb">UKB</a>
  <ul class="collapse">
  <li><a href="#repeat-heatmap-for-residual-score-derived-with-t1-scaling-factor" id="toc-repeat-heatmap-for-residual-score-derived-with-t1-scaling-factor" class="nav-link" data-scroll-target="#repeat-heatmap-for-residual-score-derived-with-t1-scaling-factor">Repeat heatmap for residual score derived with T1-scaling factor</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lifetime brain atrophy is correlated with longitudinally-observed atrophic changes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Anna Elisabeth Furtjes </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 14, 2024</p>
    </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.1101/2024.11.06.622274">10.1101/2024.11.06.622274</a>
      </p>
    </div>
  </div>
  </div>
  

</header>

<p>Results produced by the code below are described in the manuscript under section:<br>
<strong>LBA moderately captured observed atrophic changes that were longitudinally observed between two MRI scans nine years apart</strong>.</p>
<p>The outcome traits were derived using code displayed in ‘Data preparation’: LBC: <a href="LBC_neuro.html">neuroimaging</a> &amp; <a href="LBC_pheno.html">phenotypic</a> data; UKB: <a href="UKB_neuro.html">neuroimaging</a> &amp; <a href="./UKB_pheno.html">phenotypic</a> data. Ratio and residual scores were not flipped in these analyses, like they were in the analyses presented in the main manuscript. This does not affect the directions of effects when we were comparing e.g., LBA residual score with longitudinal residual score.</p>
<section id="load-packages" class="level1">
<h1>Load packages</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="define-function" class="level1">
<h1>Define function</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap <span class="ot">=</span> <span class="cf">function</span>(<span class="at">dat =</span> both[,<span class="fu">c</span>(<span class="st">"ICV"</span>,<span class="st">"TBV"</span>, <span class="st">"diff"</span>, <span class="st">"ratio"</span>, <span class="st">"resid"</span>)], <span class="at">axisNames =</span> <span class="fu">c</span>(<span class="st">"ICV"</span>,<span class="st">"TBV"</span>,<span class="st">"Difference</span><span class="sc">\n</span><span class="st">score"</span>,<span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score"</span>,<span class="st">"Residual</span><span class="sc">\n</span><span class="st">score"</span>)){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define function to obtain lower triangle</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  get_lower_tri<span class="ot">&lt;-</span><span class="cf">function</span>(cormat){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    cormat[<span class="fu">upper.tri</span>(cormat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(cormat)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get correlation matrix for both samples together</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  cor <span class="ot">=</span> <span class="fu">cor</span>(dat, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  cor <span class="ot">=</span> <span class="fu">get_lower_tri</span>(cor)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># melt matrix</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  melted <span class="ot">=</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(cor)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get rounded value</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  melted<span class="sc">$</span>value_round <span class="ot">=</span> <span class="fu">round</span>(melted<span class="sc">$</span>value, <span class="at">digit =</span> <span class="dv">2</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  melted<span class="sc">$</span>distance0 <span class="ot">=</span> <span class="fu">abs</span>(melted<span class="sc">$</span>value)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> melted)<span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">shape =</span> value, <span class="at">fill =</span> value, <span class="at">size =</span> distance0), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#82A0D8"</span>, <span class="at">high =</span> <span class="st">"#8DDFCB"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>   <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span> ,<span class="at">name=</span><span class="st">"Correlation"</span>, <span class="at">guide =</span> <span class="st">"legend"</span>)<span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">15</span>), <span class="at">guide =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(Var1, Var2, <span class="at">label =</span> value_round), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ggtitle("Pearson's corelations")+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> axisNames)<span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> axisNames)<span class="sc">+</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pearsons-correlations" class="level1">
<h1>Pearson’s correlations</h1>
<section id="lbc" class="level2">
<h2 class="anchored" data-anchor-id="lbc">LBC</h2>
<p>Cross-sectional estimates considered from final neuroimaging visit (4th scan, 5th visit). Figures from this analysis are reported in the main paper, and this plot is in Supplementary Plot 4.</p>
<div class="cell" data-fig.dim="[6,6]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in LBC data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## longitudinal</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>long <span class="ot">=</span> <span class="fu">fread</span>(<span class="fu">paste0</span>(out, <span class="st">"/LBC1936_longTBVWaves2and5.txt"</span>), <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"lbc36no"</span>,<span class="st">"TBVdiff_2to5"</span>,<span class="st">"TBVratio_5to2"</span>,<span class="st">"TBVresid_2to5"</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## cross-sectional</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>cross4 <span class="ot">=</span> <span class="fu">fread</span>(<span class="fu">paste0</span>(out, <span class="st">"/LBC1936_crossNeuroWave4.txt"</span>), <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"lbc36no"</span>,<span class="st">"ICV"</span>,<span class="st">"TBV"</span>, <span class="st">"diff"</span>, <span class="st">"ratio"</span>, <span class="st">"resid"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>LBC <span class="ot">=</span> <span class="fu">merge</span>(long, cross4, <span class="at">by =</span> <span class="st">"lbc36no"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># number of participants</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(LBC)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot correlations between atrophy measures</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">plot_heatmap</span>(<span class="at">dat =</span> LBC[,<span class="fu">c</span>(<span class="st">"ICV"</span>,<span class="st">"TBV"</span>, <span class="st">"diff"</span>, <span class="st">"ratio"</span>, <span class="st">"resid"</span>,<span class="st">"TBVdiff_2to5"</span>,<span class="st">"TBVratio_5to2"</span>,<span class="st">"TBVresid_2to5"</span>)], </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisNames =</span> <span class="fu">c</span>(<span class="st">"ICV"</span>,<span class="st">"TBV"</span>,<span class="st">"Difference</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>,<span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>,<span class="st">"Residual</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>,<span class="st">"Difference</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>,<span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>,<span class="st">"Residual</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>))<span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"LBC Wave 5</span><span class="sc">\n</span><span class="st">(N = "</span>,n,<span class="st">")"</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="long_assocs_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="576"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(paste0(out, "phenotypic/LBC_corPlot.jpg"), plot = p, width = 15, height = 15, units = "cm", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Residual score:</p>
<ul>
<li>r = 0.36; <strong>p</strong> = 9.9^{-10}</li>
</ul>
<p>Ratio score:</p>
<ul>
<li>r = 0.29; <strong>p</strong> = 1.4^{-6}</li>
</ul>
<p>Difference score:</p>
<ul>
<li>r = 0.3; <strong>p</strong> = 5.6^{-7}</li>
</ul>
</section>
<section id="ukb" class="level2">
<h2 class="anchored" data-anchor-id="ukb">UKB</h2>
<p>Cross-sectional estimates considered from second neuroimaging visit. Figures from this analysis are reported in the main paper, and this plot is in Supplementary Plot 5.</p>
<div class="cell" data-fig.dim="[6,6]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in UKB neuro data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>UKB <span class="ot">=</span> <span class="fu">fread</span>(<span class="fu">paste0</span>(out,<span class="st">"/UKB_neuroNoLongProcess.txt"</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># restrict to second neuroimaging visit (i.e., third visit altogether)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">=</span> UKB[UKB<span class="sc">$</span>wave <span class="sc">==</span> <span class="dv">3</span>,]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># later edit: exclude extreme outliers from longitudinal data </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVdiff_2to3_stand <span class="sc">&lt;</span> <span class="dv">10</span>),]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVdiff_2to3_stand <span class="sc">&gt;</span> (<span class="sc">-</span><span class="dv">10</span>)),]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVratio_3to2_stand <span class="sc">&lt;</span> <span class="dv">10</span>),]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVratio_3to2_stand <span class="sc">&gt;</span> (<span class="sc">-</span><span class="dv">10</span>)),]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVresid_2to3_stand <span class="sc">&lt;</span> <span class="dv">10</span>),]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>UKB3 <span class="ot">&lt;-</span> UKB3[<span class="fu">which</span>(UKB3<span class="sc">$</span>TBVresid_2to3_stand <span class="sc">&gt;</span> (<span class="sc">-</span><span class="dv">10</span>)),]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># now that more participants were excluded, need to re-calculate the residual score</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(TBV <span class="sc">~</span> ICV, <span class="at">data =</span> UKB3)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>UKB3<span class="sc">$</span>resid <span class="ot">=</span> <span class="fu">resid</span>(model)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>UKB3<span class="sc">$</span>resid_stand <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">scale</span>(UKB3<span class="sc">$</span>resid))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># number of participants</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(UKB3)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plot correlations between atrophy measures</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">plot_heatmap</span>(<span class="at">dat =</span> UKB3[,<span class="fu">c</span>(<span class="st">"ICV"</span>, <span class="st">"TBV"</span>, <span class="st">"CSF"</span>, <span class="st">"diff"</span>, <span class="st">"ratio"</span>, <span class="st">"resid"</span>, <span class="st">"TBVdiff_2to3"</span>, <span class="st">"TBVratio_3to2"</span>, <span class="st">"TBVresid_2to3"</span>)], </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisNames =</span> <span class="fu">c</span>(<span class="st">"ICV"</span>, <span class="st">"TBV"</span>, <span class="st">"CSF"</span>, <span class="st">"Difference</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Residual</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Difference</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>, <span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>, <span class="st">"Residual</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(long)"</span>))<span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"UKB</span><span class="sc">\n</span><span class="st">second neuroimaging visit</span><span class="sc">\n</span><span class="st">(N = "</span>,n,<span class="st">")"</span>))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="long_assocs_files/figure-html/corrUKB-1.png" class="img-fluid" width="576"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(paste0(out, "UKB_corPlot.jpg"), plot = p, width = 15, height = 15, units = "cm", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Residual score:</p>
<ul>
<li>r = 0.29; <strong>p</strong> = 4^{-94}</li>
</ul>
<p>Ratio score:</p>
<ul>
<li>r = 0.24; <strong>p</strong> = 3^{-64}</li>
</ul>
<p>Difference score:</p>
<ul>
<li>r = 0.21; <strong>p</strong> = 5.1^{-47}</li>
</ul>
<section id="repeat-heatmap-for-residual-score-derived-with-t1-scaling-factor" class="level3">
<h3 class="anchored" data-anchor-id="repeat-heatmap-for-residual-score-derived-with-t1-scaling-factor">Repeat heatmap for residual score derived with T1-scaling factor</h3>
<p>Figures from this analysis are reported in the main paper, and this plot is in Supplementary Plot 6.</p>
<div class="cell" data-fig.dim="[6,6]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">### make same plot only for cross-sectional measures to compare to resid Scaling factor</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>scaling <span class="ot">=</span> <span class="fu">plot_heatmap</span>(<span class="at">dat =</span> UKB3[,<span class="fu">c</span>(<span class="st">"ICV"</span>, <span class="st">"TBV"</span>, <span class="st">"T1ScalingFactor"</span>, <span class="st">"diff"</span>, <span class="st">"ratio"</span>, <span class="st">"resid"</span>, <span class="st">"residScalingFactor_stand"</span>)], </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisNames =</span> <span class="fu">c</span>(<span class="st">"ICV"</span>, <span class="st">"TBV"</span>, <span class="st">"T1 Scaling</span><span class="sc">\n</span><span class="st">Factor"</span>, <span class="st">"Difference</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Ratio</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Residual</span><span class="sc">\n</span><span class="st">score</span><span class="sc">\n</span><span class="st">(cross)"</span>, <span class="st">"Residual score</span><span class="sc">\n</span><span class="st">(scaling factor)"</span>))<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"UKB</span><span class="sc">\n</span><span class="st">second neuroimaging visit</span><span class="sc">\n</span><span class="st">(N = "</span>,n,<span class="st">")"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(paste0(out, "phenotypic/UKB_scalingFactor.jpg"), plot = scaling, width = 14, height = 14, units = "cm", dpi = 200)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>scaling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="long_assocs_files/figure-html/scaling-1.png" class="img-fluid" width="576"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>