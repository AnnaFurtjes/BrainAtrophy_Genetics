{
  "hash": "477686e2096c6abd16dd01788a5de046",
  "result": {
    "markdown": "---\ntitle: \"MRi-Share sample\"\nformat: \n  html:\n    code-fold: true\nauthor: \"Anna Elisabeth Furtjes\"\ndate: \"20 March 2025\"\noutput: html\ndoi: 10.1101/2024.11.06.622274\n---\n\n\n------------------------------------------------------------------------\n\n\n\n\n\n\n# Load packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\n```\n:::\n\n\nGlobal measures from the MRi-Share sample can be freely downloaded [online](https://datadryad.org/stash/dataset/doi:10.5061/dryad.q573n5tj2).\n\n\n# Read in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in MRi-Share\nShare = fread(paste0(out, \"/MRiShare_global_IDPs_BSAF2021.csv\"))\nShare$TBV = Share$SPM_GM_Volume + Share$SPM_WM_Volume\nShare = Share[,c(\"ID\", \"Age\", \"Sex\", \"eTIV\", \"TBV\")]\nnames(Share) = c(\"ID\", \"Age\", \"Sex\", \"ICV\", \"TBV\")\n\n# convert mm3 estimates to more intuitive cm3 estimates\nShare$ICV = Share$ICV/1000\nShare$TBV = Share$TBV/1000\n\n# estimate brain atrophy from single MRI scan\nShare$diff = Share$ICV - Share$TBV\nShare$ratio = Share$TBV / Share$ICV\n\nmodel <- lm(TBV ~ ICV, data = Share)\nShare$resid = resid(model)\n\n# save intercept value from the regression\nShareintercept = summary(model)$coefficients[1,1]\n\n# standardise variables\nShare$diff_stand = as.vector(scale(Share$diff))\nShare$ratio_stand = as.vector(scale(Share$ratio))\nShare$resid_stand = as.vector(scale(Share$resid))\n\n# sanity check\n#sum((Share$diff < 0))\n```\n:::\n\n\n\n# Plot distributions colored by age\n\nShown in Supplementary Figure 3: Distributions of TBV, ICV, and lifetime brain atrophy estimated with the residual, ratio, and difference method. Histograms are coloured by age groups. \n\n\n\n::: {.cell fig.dim='[20,8]'}\n\n```{.r .cell-code}\n# make age groups\nShare$Age_group <- NA\nShare$Age_group[Share$Age < 20] <- \"19 years and under\"\nShare$Age_group[Share$Age >= 20 & Share$Age < 23] <- \"20 - 22\"\nShare$Age_group[Share$Age >= 23 & Share$Age < 25] <- \"23 - 24\"\nShare$Age_group[Share$Age >= 25 & Share$Age < 27] <- \"25 - 26\"\nShare$Age_group[Share$Age >= 27 & Share$Age < 29] <- \"27 - 28\"\nShare$Age_group[Share$Age >= 29 & Share$Age < 31] <- \"29 - 30\"\nShare$Age_group[Share$Age >= 31] <- \"31 years and over\"\n\np1=ggplot(Share, aes(x=TBV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"TBV\")+\n  theme_bw()\n\np2=ggplot(Share, aes(x=ICV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"ICV\")+\n  theme_bw()\n\np3=ggplot(Share, aes(x=resid_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Residual score\")+\n  theme_bw()\n\np4=ggplot(Share, aes(x=ratio_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Ratio score\")+\n  theme_bw()\n\np5=ggplot(Share, aes(x=diff_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Difference score\")+\n  theme_bw()\n\npShare <- ggarrange(p1,p2,p3,p4,p5, nrow = 1, common.legend = T, legend = \"bottom\")\n# add title\npShare <- annotate_figure(pShare, top = text_grob(\"MRi-Share\",face = \"bold\", size = 14))\n\n#ggsave(paste0(out,\"phenotypic/Share_disttributions.jpg\"), bg = \"white\",plot = pShare, width = 30, height = 10, units = \"cm\", dpi = 300)\npShare\n```\n\n::: {.cell-output-display}\n![](MRiShare_files/figure-html/plot-1.png){width=1920}\n:::\n:::\n",
    "supporting": [
      "MRiShare_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}