{
  "hash": "0a9bd464442fa19d0d4bbffb9e1c1a32",
  "result": {
    "markdown": "---\ntitle: \"Generation Scotland Subsample (STRADL)\"\nformat: \n  html:\n    code-fold: true\nauthor: \"Anna Elisabeth Furtjes\"\ndate: \"20 March 2025\"\noutput: html\ndoi: 10.1101/2024.11.06.622274\n---\n\n\n------------------------------------------------------------------------\n\n\n\n\n\n\n# Load packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\n```\n:::\n\n\n\n\nThe STRADL data was kindly provided by Joanna Moodie where TBV and ICV had already been extracted.\n\n# Extract lifetime brain atrophy variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add in STRADL\nSTRADL = fread(paste0(STRADLdir, \"/\", list.files(path = STRADLdir, pattern = \"STRADL\")))\n\nnames(STRADL) = c(\"ID\", \"Age\", \"Sex\", \"TBV\", \"ICV\")\n\n# convert mm3 estimates to more intuitive cm3 estimates\nSTRADL$ICV = STRADL$ICV/1000\nSTRADL$TBV = STRADL$TBV/1000\n\n# estimate brain atrophy from single MRI scan\nSTRADL$diff = STRADL$ICV - STRADL$TBV\nSTRADL$ratio = STRADL$TBV / STRADL$ICV\n\n# remove participants with zero estimates for TBV and ICV (11 participants)\nSTRADL = STRADL[STRADL$TBV != 0,]\nSTRADL = STRADL[STRADL$ICV != 0,]\n\n\n# remove participants where ICV is smaller than TBV (excluding 45 participants)\nSTRADL = STRADL[which(STRADL$diff > 0),]\n\nmodel <- lm(TBV ~ ICV, data = STRADL)\nSTRADL$resid = resid(model)\n\n# standardise variables\nSTRADL$diff_stand = as.vector(scale(STRADL$diff))\nSTRADL$ratio_stand = as.vector(scale(STRADL$ratio))\nSTRADL$resid_stand = as.vector(scale(STRADL$resid))\n```\n:::\n\n\n# Plot distributions colored by age\n\nShown in Supplementary Figure 3: Distributions of TBV, ICV, and lifetime brain atrophy estimated with the residual, ratio, and difference method. Histograms are coloured by age groups. \n\n\n\n::: {.cell fig.dim='[20,8]'}\n\n```{.r .cell-code}\n####################################################\n# make age groups\nSTRADL$Age_group <- NA\nSTRADL$Age_group[STRADL$Age < 30] <- \"29 years and under\"\nSTRADL$Age_group[STRADL$Age >= 30 & STRADL$Age < 40] <- \"30 - 39\"\nSTRADL$Age_group[STRADL$Age >= 40 & STRADL$Age < 50] <- \"40 - 49\"\nSTRADL$Age_group[STRADL$Age >= 50 & STRADL$Age < 60] <- \"50 - 59\"\nSTRADL$Age_group[STRADL$Age >= 60 & STRADL$Age < 70] <- \"60 - 69\"\nSTRADL$Age_group[STRADL$Age >= 70 & STRADL$Age < 80] <- \"70 - 79\"\nSTRADL$Age_group[STRADL$Age >= 80] <- \"80 years and over\"\n\np1=ggplot(STRADL, aes(x=TBV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"TBV\")+\n  theme_bw()\n\np2=ggplot(STRADL, aes(x=ICV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"ICV\")+\n  theme_bw()\n\np3=ggplot(STRADL, aes(x=resid_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Residual score\")+\n  theme_bw()\n\np4=ggplot(STRADL, aes(x=ratio_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Ratio score\")+\n  theme_bw()\n\np5=ggplot(STRADL, aes(x=diff_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Difference score\")+\n  theme_bw()\n\npSTRADL <- ggarrange(p1,p2,p3,p4,p5, nrow = 1, common.legend = T, legend = \"bottom\")\n\n# add title\npSTRADL <- annotate_figure(pSTRADL, top = text_grob(\"STRADL\",face = \"bold\", size = 14))\n\n#ggsave(paste0(out,\"phenotypic/STRADL_disttributions.jpg\"), bg = \"white\",plot = pSTRADL, width = 30, height = 10, units = \"cm\", dpi = 300)\npSTRADL\n```\n\n::: {.cell-output-display}\n![](STRADL_files/figure-html/plot-1.png){width=1920}\n:::\n:::\n",
    "supporting": [
      "STRADL_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}