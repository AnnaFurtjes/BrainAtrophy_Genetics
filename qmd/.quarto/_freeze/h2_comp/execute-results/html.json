{
  "hash": "e1b4771609bf7bc010889420dca687d3",
  "result": {
    "markdown": "---\ntitle: \"Conservative z-tests to compare heritability estimates\"\nformat: \n  html:\n    code-fold: true\nauthor: \"Anna Elisabeth Furtjes\"\ndate: \"25 March 2025\"\noutput: html\ndoi: 10.1101/2024.11.06.622274\n---\n\n\n------------------------------------------------------------------------\n\nThis was only added on request of the reviewers. There may be a more elegant way to test whether there is a significant difference between two heritability estimates, this is certainly the most straightforward one, assuming that the difference between the h2 estimates follow a normal distribution (which I think is questionable?).\nThe formula I use here includes a correlation term in the denominator (the correlation between the two heritability estimates taken from LDSC calculations), which will increase the z value (i.e., be more likely significant) because we are dividing the difference between two values by a smaller number \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# h2 residual score\nh2_1 <- 0.41\n# h2 ratio score\nh2_2 <- 0.42\nse_1 <- 0.01\nse_2 <- 0.01\n\n# correlation between h2 taken from LDSC correlations\ncorr = 0.96\n\n# calculate z score\nz = (h2_1 - h2_2)/sqrt(se_1^2 + se_2^2 - (2 * corr * se_1 * se_2))\n#z\n\n# get p-value for z score one tailed test\np = pnorm(q = z,\n          mean = 0, # mean of the normal distribution\n          sd = 1,\n          lower.tail = T) # standard deviation of the normal distribution\n\n# not multiplying by 2 here because I have a specific expectation that one estimate is larger here and I am only asking whether it is or it isnt \n\nif (p < 0.05) {\n  res_ratio = paste0(\"Reject the null hypothesis:\\nh2 for the residual score is significantly smaller than h2 for the ratio score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n} else {\n  res_ratio = paste0(\"Fail to reject the null hypothesis:\\nh2 for the residual score is not significantly smaller than h2 for the ratio score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n}\n#################################\n# h2 residual score\nh2_1 <- 0.41\n# h2 difference score\nh2_2 <- 0.47\nse_1 <- 0.01\nse_2 <- 0.01\n\n# correlation between h2 taken from LDSC correlations\ncorr = 0.72\n\n# calculate z score\nz = (h2_1 - h2_2)/sqrt(se_1^2 + se_2^2 - (2 * corr * se_1 * se_2))\n#z\n\n# get p-value for z score\np = pnorm(q = z,\n          mean = 0, # mean of the normal distribution\n          sd = 1,\n          lower.tail = T) # standard deviation of the normal distribution\n\nif (p < 0.05) {\n  res_diff = paste0(\"Reject the null hypothesis:\\nh2 for the residual score is significantly smaller than h2 for the difference score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n} else {\n  res_diff = paste0(\"Fail to reject the null hypothesis:\\nh2 for the residual score is not significantly smaller than h2 for the difference score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n}\n```\n:::\n\n\nComparison residual & ratio score:\n\nReject the null hypothesis:\nh2 for the residual score is significantly smaller than h2 for the ratio score:\nz = -3.54; p = 2e-04.\n\n\nComparison residual & difference score:\n\nReject the null hypothesis:\nh2 for the residual score is significantly smaller than h2 for the difference score:\nz = -8.02; p = 5.4e-16.\n\n\n------------------------------------------------------------------------\n\n\nReference to future self:\n\nI got confused for a minute about whether the formula contained se or se^2 values, because I found conflicting sources online. One sample z test uses se in the denominator, and the two sample z test has to consider the se of the difference between two measures which is why we exponentiate: \n\nSE of the difference between the two measures is sqrt(se^2 + se^2)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}