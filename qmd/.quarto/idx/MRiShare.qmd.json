{"title":"MRi-Share sample","markdown":{"yaml":{"title":"MRi-Share sample","format":{"html":{"code-fold":true}},"author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","output":"html","doi":"10.1101/2024.11.06.622274"},"headingText":"quarto::quarto_render(input = \"MRiShare.qmd\", output_file = \"MRiShare.html\")","containsRefs":false,"markdown":"\n\n------------------------------------------------------------------------\n\n\n```{r setup, include=F, warning=F, message=F, eval=T}\nload(\"paths.RData\")\n```\n\n# Load packages\n```{r packages, warning=F, message = F, error=F}\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\n```\n\nGlobal measures from the MRi-Share sample can be freely downloaded [online](https://datadryad.org/stash/dataset/doi:10.5061/dryad.q573n5tj2).\n\n\n# Read in data\n\n```{r read, message = F, error=F}\n# read in MRi-Share\nShare = fread(paste0(out, \"/MRiShare_global_IDPs_BSAF2021.csv\"))\nShare$TBV = Share$SPM_GM_Volume + Share$SPM_WM_Volume\nShare = Share[,c(\"ID\", \"Age\", \"Sex\", \"eTIV\", \"TBV\")]\nnames(Share) = c(\"ID\", \"Age\", \"Sex\", \"ICV\", \"TBV\")\n\n# convert mm3 estimates to more intuitive cm3 estimates\nShare$ICV = Share$ICV/1000\nShare$TBV = Share$TBV/1000\n\n# estimate brain atrophy from single MRI scan\nShare$diff = Share$ICV - Share$TBV\nShare$ratio = Share$TBV / Share$ICV\n\nmodel <- lm(TBV ~ ICV, data = Share)\nShare$resid = resid(model)\n\n# save intercept value from the regression\nShareintercept = summary(model)$coefficients[1,1]\n\n# standardise variables\nShare$diff_stand = as.vector(scale(Share$diff))\nShare$ratio_stand = as.vector(scale(Share$ratio))\nShare$resid_stand = as.vector(scale(Share$resid))\n\n# sanity check\n#sum((Share$diff < 0))\n```\n\n\n# Plot distributions colored by age\n\nShown in Supplementary Figure 3: Distributions of TBV, ICV, and lifetime brain atrophy estimated with the residual, ratio, and difference method. Histograms are coloured by age groups. \n\n\n```{r plot, message = F, error=F, fig.dim=c(20,8)}\n# make age groups\nShare$Age_group <- NA\nShare$Age_group[Share$Age < 20] <- \"19 years and under\"\nShare$Age_group[Share$Age >= 20 & Share$Age < 23] <- \"20 - 22\"\nShare$Age_group[Share$Age >= 23 & Share$Age < 25] <- \"23 - 24\"\nShare$Age_group[Share$Age >= 25 & Share$Age < 27] <- \"25 - 26\"\nShare$Age_group[Share$Age >= 27 & Share$Age < 29] <- \"27 - 28\"\nShare$Age_group[Share$Age >= 29 & Share$Age < 31] <- \"29 - 30\"\nShare$Age_group[Share$Age >= 31] <- \"31 years and over\"\n\np1=ggplot(Share, aes(x=TBV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"TBV\")+\n  theme_bw()\n\np2=ggplot(Share, aes(x=ICV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"ICV\")+\n  theme_bw()\n\np3=ggplot(Share, aes(x=resid_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Residual score\")+\n  theme_bw()\n\np4=ggplot(Share, aes(x=ratio_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Ratio score\")+\n  theme_bw()\n\np5=ggplot(Share, aes(x=diff_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Difference score\")+\n  theme_bw()\n\npShare <- ggarrange(p1,p2,p3,p4,p5, nrow = 1, common.legend = T, legend = \"bottom\")\n# add title\npShare <- annotate_figure(pShare, top = text_grob(\"MRi-Share\",face = \"bold\", size = 14))\n\n#ggsave(paste0(out,\"phenotypic/Share_disttributions.jpg\"), bg = \"white\",plot = pShare, width = 30, height = 10, units = \"cm\", dpi = 300)\npShare\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"MRiShare.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"journal","title":"MRi-Share sample","author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","doi":"10.1101/2024.11.06.622274"},"extensions":{"book":{"multiFile":true}}}}}