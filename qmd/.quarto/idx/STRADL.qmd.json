{"title":"Generation Scotland Subsample (STRADL)","markdown":{"yaml":{"title":"Generation Scotland Subsample (STRADL)","format":{"html":{"code-fold":true}},"author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","output":"html","doi":"10.1101/2024.11.06.622274"},"headingText":"quarto::quarto_render(input = \"STRADL.qmd\", output_file = \"STRADL.html\")","containsRefs":false,"markdown":"\n\n------------------------------------------------------------------------\n\n\n```{r setup, include=F, warning=F, message=F, eval=T}\nload(\"paths.RData\")\n```\n\n# Load packages\n```{r, message=F, warning=F}\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(ggpubr)\n```\n\n\n\nThe STRADL data was kindly provided by Joanna Moodie where TBV and ICV had already been extracted.\n\n# Extract lifetime brain atrophy variables\n\n```{r extract, eval = T, message=F, warning=F}\n# add in STRADL\nSTRADL = fread(paste0(STRADLdir, \"/\", list.files(path = STRADLdir, pattern = \"STRADL\")))\n\nnames(STRADL) = c(\"ID\", \"Age\", \"Sex\", \"TBV\", \"ICV\")\n\n# convert mm3 estimates to more intuitive cm3 estimates\nSTRADL$ICV = STRADL$ICV/1000\nSTRADL$TBV = STRADL$TBV/1000\n\n# estimate brain atrophy from single MRI scan\nSTRADL$diff = STRADL$ICV - STRADL$TBV\nSTRADL$ratio = STRADL$TBV / STRADL$ICV\n\n# remove participants with zero estimates for TBV and ICV (11 participants)\nSTRADL = STRADL[STRADL$TBV != 0,]\nSTRADL = STRADL[STRADL$ICV != 0,]\n\n\n# remove participants where ICV is smaller than TBV (excluding 45 participants)\nSTRADL = STRADL[which(STRADL$diff > 0),]\n\nmodel <- lm(TBV ~ ICV, data = STRADL)\nSTRADL$resid = resid(model)\n\n# standardise variables\nSTRADL$diff_stand = as.vector(scale(STRADL$diff))\nSTRADL$ratio_stand = as.vector(scale(STRADL$ratio))\nSTRADL$resid_stand = as.vector(scale(STRADL$resid))\n```\n\n# Plot distributions colored by age\n\nShown in Supplementary Figure 3: Distributions of TBV, ICV, and lifetime brain atrophy estimated with the residual, ratio, and difference method. Histograms are coloured by age groups. \n\n\n```{r plot, eval=T, message=F, warning=F, fig.dim=c(20,8)}\n####################################################\n# make age groups\nSTRADL$Age_group <- NA\nSTRADL$Age_group[STRADL$Age < 30] <- \"29 years and under\"\nSTRADL$Age_group[STRADL$Age >= 30 & STRADL$Age < 40] <- \"30 - 39\"\nSTRADL$Age_group[STRADL$Age >= 40 & STRADL$Age < 50] <- \"40 - 49\"\nSTRADL$Age_group[STRADL$Age >= 50 & STRADL$Age < 60] <- \"50 - 59\"\nSTRADL$Age_group[STRADL$Age >= 60 & STRADL$Age < 70] <- \"60 - 69\"\nSTRADL$Age_group[STRADL$Age >= 70 & STRADL$Age < 80] <- \"70 - 79\"\nSTRADL$Age_group[STRADL$Age >= 80] <- \"80 years and over\"\n\np1=ggplot(STRADL, aes(x=TBV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"TBV\")+\n  theme_bw()\n\np2=ggplot(STRADL, aes(x=ICV, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"ICV\")+\n  theme_bw()\n\np3=ggplot(STRADL, aes(x=resid_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Residual score\")+\n  theme_bw()\n\np4=ggplot(STRADL, aes(x=ratio_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Ratio score\")+\n  theme_bw()\n\np5=ggplot(STRADL, aes(x=diff_stand, fill=Age_group)) +\n  geom_histogram()+\n  scale_fill_manual(\"Age groups\", values = c(\"#292f56\", \"#1e4572\", \"#005c8b\", \"#008ba0\", \"#00bca1\",\"#69e882\", \"#acfa70\"))+\n  xlab(\"Difference score\")+\n  theme_bw()\n\npSTRADL <- ggarrange(p1,p2,p3,p4,p5, nrow = 1, common.legend = T, legend = \"bottom\")\n\n# add title\npSTRADL <- annotate_figure(pSTRADL, top = text_grob(\"STRADL\",face = \"bold\", size = 14))\n\n#ggsave(paste0(out,\"phenotypic/STRADL_disttributions.jpg\"), bg = \"white\",plot = pSTRADL, width = 30, height = 10, units = \"cm\", dpi = 300)\npSTRADL\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"STRADL.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"journal","title":"Generation Scotland Subsample (STRADL)","author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","doi":"10.1101/2024.11.06.622274"},"extensions":{"book":{"multiFile":true}}}}}