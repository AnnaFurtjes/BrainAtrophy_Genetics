{"title":"Conservative z-tests to compare heritability estimates","markdown":{"yaml":{"title":"Conservative z-tests to compare heritability estimates","format":{"html":{"code-fold":true}},"author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","output":"html","doi":"10.1101/2024.11.06.622274"},"headingText":"h2 residual score","containsRefs":false,"markdown":"\n\n------------------------------------------------------------------------\n\nThis was only added on request of the reviewers. There may be a more elegant way to test whether there is a significant difference between two heritability estimates, this is certainly the most straightforward one, assuming that the difference between the h2 estimates follow a normal distribution (which I think is questionable?).\nThe formula I use here includes a correlation term in the denominator (the correlation between the two heritability estimates taken from LDSC calculations), which will increase the z value (i.e., be more likely significant) because we are dividing the difference between two values by a smaller number \n\n\n```{r, message=F, warning=F}\nh2_1 <- 0.41\n# h2 ratio score\nh2_2 <- 0.42\nse_1 <- 0.01\nse_2 <- 0.01\n\n# correlation between h2 taken from LDSC correlations\ncorr = 0.96\n\n# calculate z score\nz = (h2_1 - h2_2)/sqrt(se_1^2 + se_2^2 - (2 * corr * se_1 * se_2))\n#z\n\n# get p-value for z score one tailed test\np = pnorm(q = z,\n          mean = 0, # mean of the normal distribution\n          sd = 1,\n          lower.tail = T) # standard deviation of the normal distribution\n\n# not multiplying by 2 here because I have a specific expectation that one estimate is larger here and I am only asking whether it is or it isnt \n\nif (p < 0.05) {\n  res_ratio = paste0(\"Reject the null hypothesis:\\nh2 for the residual score is significantly smaller than h2 for the ratio score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n} else {\n  res_ratio = paste0(\"Fail to reject the null hypothesis:\\nh2 for the residual score is not significantly smaller than h2 for the ratio score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n}\n#################################\n# h2 residual score\nh2_1 <- 0.41\n# h2 difference score\nh2_2 <- 0.47\nse_1 <- 0.01\nse_2 <- 0.01\n\n# correlation between h2 taken from LDSC correlations\ncorr = 0.72\n\n# calculate z score\nz = (h2_1 - h2_2)/sqrt(se_1^2 + se_2^2 - (2 * corr * se_1 * se_2))\n#z\n\n# get p-value for z score\np = pnorm(q = z,\n          mean = 0, # mean of the normal distribution\n          sd = 1,\n          lower.tail = T) # standard deviation of the normal distribution\n\nif (p < 0.05) {\n  res_diff = paste0(\"Reject the null hypothesis:\\nh2 for the residual score is significantly smaller than h2 for the difference score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n} else {\n  res_diff = paste0(\"Fail to reject the null hypothesis:\\nh2 for the residual score is not significantly smaller than h2 for the difference score:\\nz = \", round(z, digits=2), \"; p = \", signif(p, digits=2),\".\")\n}\n```\n\nComparison residual & ratio score:\n\n`r res_ratio`\n\n\nComparison residual & difference score:\n\n`r res_diff`\n\n\n------------------------------------------------------------------------\n\n\nReference to future self:\n\nI got confused for a minute about whether the formula contained se or se^2 values, because I found conflicting sources online. One sample z test uses se in the denominator, and the two sample z test has to consider the se of the difference between two measures which is why we exponentiate: \n\nSE of the difference between the two measures is sqrt(se^2 + se^2)\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"h2_comp.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"journal","title":"Conservative z-tests to compare heritability estimates","author":"Anna Elisabeth Furtjes","date":"`r format(Sys.time(), '%d %B %Y')`","doi":"10.1101/2024.11.06.622274"},"extensions":{"book":{"multiFile":true}}}}}